/*
 * ----------------------------------------------------------------------------
 * "THE BEER-WARE LICENSE" (Revision 42):
 * <Martin@Revoltera.com> wrote this file. As long as you retain this notice,
 * you can do whatever you want with this stuff. If we meet some day, and you
 * think this stuff is worth it, you can buy me a beer in return.
 * ----------------------------------------------------------------------------
 */

!function(n){n.fn.polygonizr=function(e){var t={restNodeMovements:1,duration:3,nodeMovementDistance:100,numberOfNodes:25,numberOfUnconnectedNode:25,ConnectUnconnectedNodes:!0,ConnectUnconnectedNodesDistance:150,nodeDotSize:2.5,nodeEase:"easeOut",nodeFancyEntrance:!1,randomizePolygonMeshNetworkFormation:!0,specifyPolygonMeshNetworkFormation:null,nodeRelations:3,animationFps:30,nodeDotColor:"240, 255, 250",nodeLineColor:"240, 255, 250",nodeFillColor:"240, 255, 250",nodeFillAlpha:.5,nodeLineAlpha:.5,nodeDotAlpha:1,nodeDotPrediction:0,nodeFillSapce:!0,nodeOverflow:!0,nodeGlowing:!1,canvasWidth:n(this).width(),canvasHeight:n(this).height(),canvasPosition:"absolute",canvasTop:"auto",canvasBottom:"auto",canvasRight:"auto",canvasLeft:"auto"},o=n.extend({},t,e);return this.each(function(){var e=n(this),t=document.createElement("canvas");t.width=o.canvasWidth,t.height=o.canvasHeight,t.style.position=o.canvasPosition,t.style.top=o.canvasTop,t.style.bottom=o.canvasBottom,t.style.right=o.canvasRight,t.style.left=o.canvasLeft,e.append(t);var a=t.getContext("2d"),i=[];!function(){for(var n=0;n<o.numberOfNodes+o.numberOfUnconnectedNode;n++){var e={x:0,y:0};o.randomizePolygonMeshNetworkFormation?(e.x=Math.random()*o.canvasWidth,e.y=Math.random()*o.canvasHeight):e=o.specifyPolygonMeshNetworkFormation(n),i.push({currentX:e.x,originX:e.x,startX:e.x,targetX:e.x,currentY:e.y,originY:e.y,startY:e.x,targetY:e.y}),i[n].UnconnectedNode=o.numberOfUnconnectedNode>n}for(var n=0;n<i.length;n++){for(var t=[],a=i[n],r=0;r<i.length;r++){var l=i[r];if(a!=l)for(var s=0;s<o.nodeRelations;s++){if(null==t[s]){t[s]=l;break}if(g(a,l)<g(a,t[s])){t[s]=l;break}}}a.Closest=t,h(a)}}(),new l(o.nodeEase,o.animationFps,o.duration,o.restNodeMovements,o.nodeFancyEntrance,u).start();const r={Animation:{EASING_LINEAR:"linear",EASING_EASEIN:"easeIn",EASING_EASEOUT:"easeOut",EASING_EASEINOUT:"easeInOut",EASING_ACCELERATE:"accelerateDecelerate",EASING_DESCENDING:"descendingEntrance"}};function l(n,e,t,a,l,s){function h(t){p||(p=t),N||(N=t);var a=Math.floor((t-p)/(1e3/e));if(g<a){g=a;var m=t-N;m<=u?(w&&(!function(){for(var n in i){for(var e=d(i[n].originX),t=d(i[n].originY);0==o.nodeOverflow&&0==v(e,t);)e=d(i[n].originX),t=d(i[n].originY);i[n].targetX=e,i[n].targetY=t,i[n].startX=i[n].currentX,i[n].startY=i[n].currentY,i[n].NodePrediction=o.nodeDotPrediction>0&&Math.random()<=o.nodeDotPrediction}}(),w=!1),c(C&&l?r.Animation.EASING_DESCENDING:n,m,u),s&&"function"==typeof s&&s()):m>=u+A&&(N=t,w=!0,C=!1)}E=f(h)}this.isRunning=!1,this.start=function(){this.isRunning||(this.isRunning=!0,u=1e3*t,A=1e3*a,E=f(h))},this.pause=function(){this.isRunning&&(m(E),this.isRunning=!1,p=null,g=-1)};var u,A,f=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame,m=window.cancelAnimationFrame||window.mozCancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame,p=null,g=-1,E=null,N=null,w=!0,C=!0}function s(n,e,t,o,a){switch(n){case r.Animation.EASING_LINEAR:return e/a*(o-t)+t;case r.Animation.EASING_EASEIN:return e/=a,(o-t)*Math.pow(e,2)+t;case r.Animation.EASING_EASEOUT:return-(o-t)*(e/=a)*(e-2)+t;case r.Animation.EASING_EASEINOUT:return(e/=a/2)<1?(o-t)/2*Math.pow(e,2)+t:-(o-t)/2*((e-1)*(e-1-2)-1)+t;case r.Animation.EASING_ACCELERATE:return(e/=a/2)<1?(o-t)/2*Math.pow(e,3)+t:(o-t)/2*(Math.pow(e-2,3)+2)+t;case r.Animation.EASING_DESCENDING:return(e/=a/2)<1?(o-t)/Math.pow(e,3)+t:(o-t)/(Math.pow(e-2,3)+2)+t;default:return s(r.Animation.EASING_LINEAR,e,t,o,a)}}function c(n,e,t){for(var o in i)i[o].currentX=s(n,e,i[o].startX,i[o].targetX,t),i[o].currentY=s(n,e,i[o].startY,i[o].targetY,t)}function d(n){return n+(Math.random()<.5?-Math.random():Math.random())*o.nodeMovementDistance}function h(n){var e=Math.sqrt(Math.pow(o.canvasWidth,2)+Math.pow(o.canvasHeight,2)),t=0;for(var a in n.Closest)t+=g(n.Closest[a],n.Closest[(a+1)%n.Closest.length]);var i=1-t/e;n.lineAlpha=i*o.nodeLineAlpha,n.dotAlpha=i*o.nodeDotAlpha,i>.85?(n.fillAlpha=i*o.nodeFillAlpha,n.lineAlpha=o.nodeLineAlpha,n.dotAlpha=o.nodeDotAlpha):i<.8&&i>.7?(n.fillAlpha=.5*i*o.nodeFillAlpha,n.lineAlpha=o.nodeLineAlpha,n.dotAlpha=o.nodeDotAlpha):n.fillAlpha=i<.7&&i>.4?.2*i*o.nodeFillAlpha:0}function u(){for(var n in a.clearRect(0,0,o.canvasWidth,o.canvasHeight),i)A(i[n]),p(i[n])}function A(n){if(!(!n.lineAlpha>0&&!n.fillAlpha>0))for(var e in n.Closest){var t=0==n.Closest[e].UnconnectedNode&&0==n.UnconnectedNode,a=1==o.ConnectUnconnectedNodes&&g(n,n.Closest[e])<=o.ConnectUnconnectedNodesDistance;(t||a)&&(n.lineAlpha>0&&f(n,e),o.nodeFillSapce&&n.fillAlpha>0&&1==t&&m(n,e))}}function f(n,e){a.beginPath(),a.moveTo(n.currentX,n.currentY),a.lineTo(n.Closest[e].currentX,n.Closest[e].currentY),a.strokeStyle="rgba("+o.nodeLineColor+","+n.lineAlpha+")",a.stroke()}function m(n,e){a.beginPath(),a.moveTo(n.currentX,n.currentY),a.lineTo(n.Closest[e].currentX,n.Closest[e].currentY),a.lineTo(n.Closest[(e+1)%n.Closest.length].currentX,n.Closest[(e+1)%n.Closest.length].currentY),a.fillStyle="rgba("+o.nodeFillColor+","+n.fillAlpha+")",a.fill()}function p(n){if(!(!n.dotAlpha>0)){if(a.beginPath(),a.arc(n.currentX,n.currentY,o.nodeDotSize,0,2*Math.PI,!1),a.fillStyle="rgba("+o.nodeDotColor+", "+n.dotAlpha+")",o.nodeGlowing&&(a.shadowBlur=10,a.shadowColor="rgba("+o.nodeDotColor+", "+n.dotAlpha+")"),1==n.NodePrediction){var e=o.nodeDotSize*Math.PI,t=e/2;a.font=e+"px Arial",a.strokeRect(n.targetX-t,n.targetY-t,e,e),a.fillText(n.targetX+", "+n.targetY,n.targetX+e,n.targetY-t)}a.fill()}}function g(n,e){return Math.sqrt(Math.pow(n.currentX-e.currentX,2)+Math.pow(n.currentY-e.currentY,2))}function v(n,e){return n>0&&n<o.canvasWidth&&e>0&&e<o.canvasHeight}})}}(jQuery);
